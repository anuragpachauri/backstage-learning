(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3207],{54748:(F,x,n)=>{"use strict";n.d(x,{M:()=>y});var N=n(58837),u=n(71677),h=n(14041),$=n(72501);const C=(0,N.A)({container:{overflow:"visible !important"},typo:{fontSize:"inherit",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":({line:L})=>L||1,"-webkit-box-orient":"vertical"}},{name:"BackstageOverflowTooltip"});function y(L){const K=C(L);return h.createElement(u.Ay,{title:L.title??(L.text||""),placement:L.placement},h.createElement($.A,{className:K.typo,variant:"inherit"},L.text))}},23207:(F,x,n)=>{"use strict";n.r(x),n.d(x,{GroupProfileCard:()=>$t,MembersListCard:()=>ut,MyGroupsSidebarItem:()=>oa,OwnershipCard:()=>Xt,UserProfileCard:()=>Nt});var N=n(55488),u=n(78560),h=n(37281),$=n(16400),C=n(30043),y=n(77125),L=n(42899),K=n(73643),R=n(72501),M=n(58837),E=n(99703),i=n(89575),m=n(39850),e=n(14041),z=n(9546),I=n(7031),T=n(83705),We=n(90689),Fe=n(45065);function Ve(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=a.boundaryCount,r=t===void 0?1:t,o=a.componentName,s=o===void 0?"usePagination":o,d=a.count,l=d===void 0?1:d,c=a.defaultPage,v=c===void 0?1:c,p=a.disabled,f=p===void 0?!1:p,g=a.hideNextButton,w=g===void 0?!1:g,A=a.hidePrevButton,P=A===void 0?!1:A,B=a.onChange,b=a.page,S=a.showFirstButton,U=S===void 0?!1:S,k=a.showLastButton,X=k===void 0?!1:k,ae=a.siblingCount,V=ae===void 0?1:ae,le=(0,m.A)(a,["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"]),D=(0,Fe.A)({controlled:b,default:v,name:s,state:"page"}),j=(0,We.A)(D,2),O=j[0],ce=j[1],J=function(Z,q){b||ce(q),B&&B(Z,q)},W=function(Z,q){var ia=q-Z+1;return Array.from({length:ia},function(ca,la){return Z+la})},ne=W(1,Math.min(r,l)),Y=W(Math.max(l-r+1,r+1),l),ve=Math.max(Math.min(O-V,l-r-V*2-1),r+2),Oe=Math.min(Math.max(O+V,r+V*2+2),Y[0]-2),ra=[].concat((0,T.A)(U?["first"]:[]),(0,T.A)(P?[]:["previous"]),(0,T.A)(ne),(0,T.A)(ve>r+2?["start-ellipsis"]:r+1<l-r?[r+1]:[]),(0,T.A)(W(ve,Oe)),(0,T.A)(Oe<l-r-1?["end-ellipsis"]:l-r>r?[l-r]:[]),(0,T.A)(Y),(0,T.A)(w?[]:["next"]),(0,T.A)(X?["last"]:[])),ke=function(Z){switch(Z){case"first":return 1;case"previous":return O-1;case"next":return O+1;case"last":return l;default:return null}},sa=ra.map(function(G){return typeof G=="number"?{onClick:function(q){J(q,G)},type:"page",page:G,selected:G===O,disabled:f,"aria-current":G===O?"true":void 0}:{onClick:function(q){J(q,ke(G))},type:G,page:ke(G),selected:!1,disabled:f||G.indexOf("ellipsis")===-1&&(G==="next"||G==="last"?O>=l:O<=1)}});return(0,i.A)({items:sa},le)}var _=n(268),Ke=n(54917),He=n(97740),de=n(38483);const Ce=(0,de.A)(e.createElement("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),Ne=(0,de.A)(e.createElement("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),Se=(0,de.A)(e.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),Le=(0,de.A)(e.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");var fe=n(11192),Qe=function(t){return{root:(0,i.A)({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:t.palette.text.primary}),page:{transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&$focusVisible":{backgroundColor:t.palette.action.focus},"&$selected":{backgroundColor:t.palette.action.selected,"&:hover, &$focusVisible":{backgroundColor:(0,_.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:1,color:t.palette.action.disabled,backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:t.palette.action.disabledOpacity}},sizeSmall:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px","& $icon":{fontSize:t.typography.pxToRem(18)}},sizeLarge:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15),"& $icon":{fontSize:t.typography.pxToRem(22)}},textPrimary:{"&$selected":{color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.primary.dark,"@media (hover: none)":{backgroundColor:t.palette.primary.main}},"&$disabled":{color:t.palette.action.disabled}}},textSecondary:{"&$selected":{color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.secondary.dark,"@media (hover: none)":{backgroundColor:t.palette.secondary.main}},"&$disabled":{color:t.palette.action.disabled}}},outlined:{border:"1px solid ".concat(t.palette.type==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$selected":{"&$disabled":{border:"1px solid ".concat(t.palette.action.disabledBackground)}}},outlinedPrimary:{"&$selected":{color:t.palette.primary.main,border:"1px solid ".concat((0,_.X4)(t.palette.primary.main,.5)),backgroundColor:(0,_.X4)(t.palette.primary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:(0,_.X4)(t.palette.primary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},outlinedSecondary:{"&$selected":{color:t.palette.secondary.main,border:"1px solid ".concat((0,_.X4)(t.palette.secondary.main,.5)),backgroundColor:(0,_.X4)(t.palette.secondary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:(0,_.X4)(t.palette.secondary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},rounded:{borderRadius:t.shape.borderRadius},ellipsis:{height:"auto","&$disabled":{opacity:t.palette.action.disabledOpacity}},focusVisible:{},disabled:{},selected:{},icon:{fontSize:t.typography.pxToRem(20),margin:"0 -8px"}}},Xe=e.forwardRef(function(t,r){var o=t.classes,s=t.className,d=t.color,l=d===void 0?"standard":d,c=t.component,v=t.disabled,p=v===void 0?!1:v,f=t.page,g=t.selected,w=g===void 0?!1:g,A=t.shape,P=A===void 0?"round":A,B=t.size,b=B===void 0?"medium":B,S=t.type,U=S===void 0?"page":S,k=t.variant,X=k===void 0?"text":k,ae=(0,m.A)(t,["classes","className","color","component","disabled","page","selected","shape","size","type","variant"]),V=(0,Ke.A)(),le=V.direction==="rtl"?{previous:Le,next:Se,last:Ce,first:Ne}:{previous:Se,next:Le,first:Ce,last:Ne},D=le[U];return U==="start-ellipsis"||U==="end-ellipsis"?e.createElement("div",{ref:r,className:(0,z.default)(o.root,o.ellipsis,p&&o.disabled,b!=="medium"&&o["size".concat((0,fe.A)(b))])},"\u2026"):e.createElement(He.A,(0,i.A)({ref:r,component:c,disabled:p,focusVisibleClassName:o.focusVisible,className:(0,z.default)(o.root,o.page,o[X],o[P],s,l!=="standard"&&o["".concat(X).concat((0,fe.A)(l))],p&&o.disabled,w&&o.selected,b!=="medium"&&o["size".concat((0,fe.A)(b))])},ae),U==="page"&&f,D?e.createElement(D,{className:o.icon}):null)});const je=(0,I.A)(Qe,{name:"MuiPaginationItem"})(Xe);var Ye={root:{},ul:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}};function Je(a,t,r){return a==="page"?"".concat(r?"":"Go to ","page ").concat(t):"Go to ".concat(a," page")}var Ze=e.forwardRef(function(t,r){var o=t.boundaryCount,s=t.classes,d=t.className,l=t.color,c=l===void 0?"standard":l,v=t.count,p=t.defaultPage,f=t.disabled,g=t.getItemAriaLabel,w=g===void 0?Je:g,A=t.hideNextButton,P=t.hidePrevButton,B=t.onChange,b=t.page,S=t.renderItem,U=S===void 0?function(Y){return e.createElement(je,Y)}:S,k=t.shape,X=k===void 0?"round":k,ae=t.showFirstButton,V=t.showLastButton,le=t.siblingCount,D=t.size,j=D===void 0?"medium":D,O=t.variant,ce=O===void 0?"text":O,J=(0,m.A)(t,["boundaryCount","classes","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"]),W=Ve((0,i.A)({},t,{componentName:"Pagination"})),ne=W.items;return e.createElement("nav",(0,i.A)({"aria-label":"pagination navigation",className:(0,z.default)(s.root,d),ref:r},J),e.createElement("ul",{className:s.ul},ne.map(function(Y,ve){return e.createElement("li",{key:ve},U((0,i.A)({},Y,{color:c,"aria-label":w(Y.type,Y.page,Y.selected),shape:X,size:j,variant:ce})))})))});const qe=(0,I.A)(Ye,{name:"MuiPagination"})(Ze);var ue=n(73466),_e=n(19087);function et(a){let t=0;for(let o=0;o<a.length;o++)t=a.charCodeAt(o)+((t<<5)-t);let r="#";for(let o=0;o<3;o++){const s=t>>o*8&255;r+=`00${s.toString(16)}`.slice(-2)}return r}function tt(a){const t=a.trim().split(" "),r=t[0]??"",o=t.length>1?t[t.length-1]:"";return r&&o?`${r.charAt(0)}${o.charAt(0)}`:r.charAt(0)}var at=n(53373),me=n.n(at);const nt=(0,M.A)(a=>({avatar:{width:"4rem",height:"4rem",color:a.palette.common.white,backgroundColor:t=>t.backgroundColor},avatarText:{fontWeight:a.typography.fontWeightBold,letterSpacing:"1px",textTransform:"uppercase"}}),{name:"BackstageAvatar"});function he(a){const{displayName:t,picture:r,customStyles:o}=a,s={...o},d={fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight},l=nt(r?{}:{backgroundColor:et(t||"")}),c=me()(a.classes?.avatar,l.avatar),v=me()(a.classes?.avatarText,l.avatarText);return e.createElement(_e.A,{alt:t,src:r,className:c,style:s},t&&e.createElement(R.A,{variant:"h6",component:"span",className:v,style:d},tt(t)))}var H=n(75202),Pe=n(54748),ye=n(96872),Re=n(99424),pe=n(21332),oe=n(18139),re=n(97214),se=n(699);const ot=async(a,t,r="memberof")=>(a.length===0?{items:[]}:await t.getEntities({filter:{kind:"User",[`relations.${r.toLocaleLowerCase("en-US")}`]:a.map(s=>(0,u.U2)({kind:"group",namespace:s.namespace.toLocaleLowerCase("en-US"),name:s.name.toLocaleLowerCase("en-US")}))}})).items,rt=async(a,t)=>{const r=new Map,s=[{kind:a.kind,namespace:a.metadata.namespace??N.oQ,name:a.metadata.name}],d=[];for(;s.length>0;){const l=s.shift(),c=await t.getEntityByRef(l);r.set((0,u.U2)(l),!0);const v=(0,se.t)(c,re.Kx,{kind:"Group"}).filter(p=>!r.has((0,u.U2)(p)));v.forEach(p=>r.set((0,u.U2)(p),!0)),s.push(...v),d.push(...v)}return d},st=async(a,t,r="memberof")=>ot(await rt(a,t),t,r),it=a=>{const t=new Map;return a.filter(r=>{const o=(0,u.U2)(r),s=t.has(o);return t.set(o,!0),!s})},lt=(0,M.A)(a=>(0,E.A)({card:{border:`1px solid ${a.palette.divider}`,boxShadow:a.shadows[2],borderRadius:"4px",overflow:"visible",position:"relative",margin:a.spacing(4,1,1),flex:"1",minWidth:"0px"},avatar:{position:"absolute",top:"-2rem"}}),{name:"MembersListCardComponent"}),ct=a=>{const t=lt(),{metadata:{name:r,description:o},spec:{profile:s}}=a.member,d=s?.displayName??r;return e.createElement(y.A,{className:t.card},e.createElement(y.A,{display:"flex",flexDirection:"column",m:3,alignItems:"center",justifyContent:"center"},e.createElement(he,{displayName:d,picture:s?.picture,classes:t}),e.createElement(y.A,{pt:2,sx:{width:"100%"},textAlign:"center"},e.createElement(R.A,{variant:"h6"},e.createElement(h.z,{"data-testid":"user-link",entityRef:a.member,title:d})),s?.email&&e.createElement(H.N_,{to:`mailto:${s.email}`},e.createElement(Pe.M,{text:s.email})),o&&e.createElement(R.A,{variant:"subtitle2"},o))))},dt=(0,M.A)(a=>({root:{height:"100%"},cardContent:{overflow:"auto"},memberList:{display:"grid",gap:a.spacing(1.5),gridTemplateColumns:`repeat(auto-fit, minmax(auto, ${a.spacing(34)}px))`}})),ut=a=>{const{memberDisplayTitle:t="Members",pageSize:r=50,showAggregateMembersToggle:o,relationType:s="memberof"}=a,d=a.relationAggregation??a.relationsType??"direct",l=dt(),{entity:c}=(0,$.tN)(),{metadata:{name:v,namespace:p},spec:{profile:f}}=c,g=(0,oe.gf)(C.v),w=f?.displayName??v,A=p||N.oQ,[P,B]=e.useState(1),b=(W,ne)=>{B(ne)},[S,U]=(0,e.useState)(d==="aggregated"),{loading:k,value:X}=(0,ue.A)(async()=>S?await st(c,g,s):[],[g,c,S]),{loading:ae,error:V,value:le}=(0,ue.A)(async()=>(await g.getEntities({filter:{kind:"User",[`relations.${s.toLocaleLowerCase("en-US")}`]:[(0,u.U2)({kind:"group",namespace:A.toLocaleLowerCase("en-US"),name:v.toLocaleLowerCase("en-US")})]}})).items,[g,c]),D=it([...le??[],...X&&S?X:[]].sort((W,ne)=>(0,u.U2)(W).localeCompare((0,u.U2)(ne))));if(ae)return e.createElement(ye.k,null);if(V)return e.createElement(Re._,{error:V});const j=Math.ceil((D?.length||0)/r),O=j<2?"":`, page ${P} of ${j}`,ce=e.createElement(qe,{count:j,page:P,onChange:b,showFirstButton:!0,showLastButton:!0});let J;return D&&D.length>0?J=e.createElement(y.A,{className:l.memberList},D.slice(r*(P-1),r*P).map(W=>e.createElement(ct,{member:W,key:(0,u.U2)(W)}))):J=e.createElement(y.A,{p:2},e.createElement(R.A,null,"This group has no ",t.toLocaleLowerCase(),".")),e.createElement(L.A,{item:!0,className:l.root},e.createElement(pe.n,{title:`${t} (${D?.length||0}${O})`,subheader:`of ${w}`,...j<=1?{}:{actions:ce},className:l.root,cardClassName:l.cardContent},o&&e.createElement(e.Fragment,null,"Direct Members",e.createElement(K.A,{color:"primary",checked:S,onChange:()=>{U(!S)},inputProps:{"aria-label":"Users Type Switch"}}),"Aggregated Members"),S&&k?e.createElement(ye.k,null):J))};var mt=n(98890),ge=n(29365),Ee=n(58007),ee=n(8109),ie=n(46423),te=n(5951),Q=n(71677),Ae=n(14158),pt=n(34477),gt=n(86486),ze=n(74219),vt=n(74011),be=n(75625),we=n(85121),$e=n(47966),ft=n(95208),xe=n(23127),ht=n(37197);const yt=({href:a,Icon:t,text:r})=>e.createElement(ee.A,{key:a},e.createElement(ie.A,null,t?e.createElement(t,null):e.createElement(xe.A,null)),e.createElement(te.A,null,e.createElement(H.N_,{to:a},r))),Ie=({links:a})=>{const t=(0,ft.n)(),r=o=>o?t.getSystemIcon(o)??xe.A:xe.A;return a===void 0?null:e.createElement(e.Fragment,null,e.createElement(ht.A,null),a.map(o=>e.createElement(yt,{key:o.url,href:o.url,text:o.title,Icon:r(o.icon)})))};var Et=n(56299),At=n(71913);const bt=a=>e.createElement(y.A,{display:"flex",alignItems:"center"},e.createElement($e.A,{fontSize:"inherit"}),e.createElement(y.A,{ml:1},a.title)),$t=a=>{const t=(0,oe.gf)(C.v),r=(0,oe.gf)(pt.k),{entity:o}=(0,$.tN)(),{allowed:s}=(0,Et.A)(At.tS),d=(0,e.useCallback)(async()=>{await t.refreshEntity((0,u.U2)(o)),r.post({message:"Refresh scheduled",severity:"info",display:"transient"})},[t,r,o]);if(!o)return e.createElement(ze.A,{severity:"error"},"Group not found");const{metadata:{name:l,description:c,title:v,annotations:p,links:f},spec:{profile:g}}=o,w=(0,se.t)(o,re.Kx,{kind:"Group"}),A=(0,se.t)(o,re.Qz,{kind:"group"}),P=p?.[mt.Eo],B=P?.startsWith("url:")||P?.startsWith("file:"),b=o.metadata.annotations?.[N.P],S=g?.displayName??v??l,U=g?.email?`mailto:${g.email}`:"#",k=b?e.createElement(ge.A,{"aria-label":"Edit",title:"Edit Metadata",component:H.N_,to:b},e.createElement(be.A,null)):e.createElement(ge.A,{"aria-label":"Edit",disabled:!0,title:"Edit Metadata"},e.createElement(be.A,null));return e.createElement(pe.n,{title:e.createElement(bt,{title:S}),subheader:c,variant:a.variant,action:e.createElement(e.Fragment,null,B&&s&&e.createElement(ge.A,{"aria-label":"Refresh",title:"Schedule entity refresh",onClick:d},e.createElement(vt.A,null)),k)},e.createElement(L.A,{container:!0,spacing:3},e.createElement(L.A,{item:!0,xs:12,sm:2,xl:1},e.createElement(he,{displayName:S,picture:g?.picture})),e.createElement(L.A,{item:!0,md:10,xl:11},e.createElement(Ee.A,null,g?.email&&e.createElement(ee.A,null,e.createElement(ie.A,null,e.createElement(Q.Ay,{title:"Email"},e.createElement(we.A,null))),e.createElement(te.A,{primary:e.createElement(H.N_,{to:U},g.email),secondary:"Email"})),e.createElement(ee.A,null,e.createElement(ie.A,null,e.createElement(Q.Ay,{title:"Parent Group"},e.createElement(gt.A,null))),e.createElement(te.A,{primary:A.length?e.createElement(Ae.i,{entityRefs:A,defaultKind:"Group"}):"N/A",secondary:"Parent Group"})),e.createElement(ee.A,null,e.createElement(ie.A,null,e.createElement(Q.Ay,{title:"Child Groups"},e.createElement($e.A,null))),e.createElement(te.A,{primary:w.length?e.createElement(Ae.i,{entityRefs:w,defaultKind:"Group"}):"N/A",secondary:"Child Groups"})),a?.showLinks&&e.createElement(Ie,{links:f})))))};var xt=n(48108);const Ct=a=>a.title?e.createElement(y.A,{display:"flex",alignItems:"center"},e.createElement(xt.A,{fontSize:"inherit"}),e.createElement(y.A,{ml:1},a.title)):null,Nt=a=>{const{entity:t}=(0,$.tN)();if(!t)return e.createElement(ze.A,{severity:"error"},"User not found");const r=t.metadata.annotations?.[N.P],{metadata:{name:o,description:s,links:d},spec:{profile:l}}=t,c=l?.displayName??o,v=l?.email?`mailto:${l.email}`:void 0,p=(0,se.t)(t,re.u0,{kind:"Group"});return e.createElement(pe.n,{title:e.createElement(Ct,{title:c}),subheader:s,variant:a.variant,action:e.createElement(e.Fragment,null,r&&e.createElement(ge.A,{"aria-label":"Edit",title:"Edit Metadata",component:H.N_,to:r},e.createElement(be.A,null)))},e.createElement(L.A,{container:!0,spacing:3,alignItems:"flex-start"},e.createElement(L.A,{item:!0,xs:12,sm:2,xl:1},e.createElement(he,{displayName:c,picture:l?.picture})),e.createElement(L.A,{item:!0,md:10,xl:11},e.createElement(Ee.A,null,l?.email&&e.createElement(ee.A,null,e.createElement(ie.A,null,e.createElement(Q.Ay,{title:"Email"},e.createElement(we.A,null))),e.createElement(te.A,null,e.createElement(H.N_,{to:v??""},l.email))),e.createElement(ee.A,null,e.createElement(ie.A,null,e.createElement(Q.Ay,{title:"Member of"},e.createElement($e.A,null))),e.createElement(te.A,null,e.createElement(Ae.i,{entityRefs:p,defaultKind:"Group"}))),a?.showLinks&&e.createElement(Ie,{links:d})))))};var St=n(65569),Me=n(72814),Lt=n(65398),Pt=n.n(Lt),Rt=n(14920),zt=n(53318),wt=n(50308),It=n.n(wt),Mt=n(45810),Tt=n.n(Mt),Te=n(45250);const Bt=It()(5),Ut=(a,t)=>{const{kind:r,type:o}=t,s=a.map(l=>(0,zt.S)((0,u.KU)(l),{defaultKind:"group"})),d={kind:r.toLocaleLowerCase("en-US"),type:o,owners:s,user:"all"};return Tt().stringify({filters:d},{arrayFormat:"repeat"})},Gt=a=>[...(0,se.t)(a,re.u0,{kind:"Group"}).map(({kind:o,namespace:s,name:d})=>(0,u.U2)({kind:o,namespace:s,name:d})),(0,u.U2)(a)],Dt=a=>a!==void 0,Be=async(a,t,r=[])=>{const o=(0,se.t)(a,re.Kx,{kind:"Group"}),s=o.length>0,d=(0,u.U2)(a);if(s){const l=o.map(g=>(0,u.U2)(g)),p=(await Bt(()=>t.getEntitiesByRefs({fields:["kind","metadata.namespace","metadata.name","relations"],entityRefs:l}))).items.filter(Dt).filter(g=>!r.includes((0,u.U2)(g))),f=(await Promise.all(p.map(g=>Be(g,t,[...r,d])))).flatMap(g=>g);return(0,Te.uniq)([...f,d])}return[d]},Ot=async(a,t,r)=>{const o=a.kind==="Group",s=t==="aggregated",d=a.kind==="User";return s&&o?Be(a,r):s&&d?Gt(a):[(0,u.U2)(a)]},kt=a=>new Promise(t=>setTimeout(t,a)),Wt=async(a,t,r,o=100,s=100)=>{const d=[];for(let l=0;l<a.length;l+=o){const c=a.slice(l,l+o),v=await r.getEntities({filter:[{kind:t,"relations.ownedBy":c}],fields:["kind","metadata.name","metadata.namespace","spec.type","relations"]});d.push(...v.items),l+o<a.length&&await kt(s)}return(0,Te.uniqBy)(d,u.U2)};function Ft(a,t,r,o=6){const s=(0,oe.gf)(C.v),d=r??["Component","API","System"],{loading:l,error:c,value:v}=(0,ue.A)(async()=>{const p=await Ot(a,t,s);return(await Wt(p,d,s)).reduce((A,P)=>{const B=A.find(b=>b.kind===P.kind&&b.type===P.spec?.type);return B?B.count+=1:A.push({kind:P.kind,type:P.spec?.type?.toString(),count:1}),A},[]).sort((A,P)=>P.count-A.count).slice(0,o).map(A=>({counter:A.count,type:A.type,kind:A.kind,queryParams:Ut(p,A)}))},[s,a,t]);return{componentsWithCounters:v,loading:l,error:c}}const Vt=(0,M.A)(a=>(0,E.A)({card:{border:`1px solid ${a.palette.divider}`,boxShadow:a.shadows[2],borderRadius:"4px",padding:a.spacing(2),transition:`${a.transitions.duration.standard}ms`,"&:hover":{boxShadow:a.shadows[4]},height:"100%"},bold:{fontWeight:a.typography.fontWeightBold},smallFont:{fontSize:a.typography.body2.fontSize},entityTypeBox:{background:t=>a.getPageTheme({themeId:t.type}).backgroundImage,color:t=>a.getPageTheme({themeId:t.type}).fontColor}})),Kt=({counter:a,type:t,kind:r,url:o})=>{const s=Vt({type:t??r}),d=t??r,l=d.length>10,c=e.createElement(y.A,{className:`${s.card} ${s.entityTypeBox}`,display:"flex",flexDirection:"column",alignItems:"center"},e.createElement(R.A,{className:s.bold,variant:"h6"},a),e.createElement(y.A,{sx:{width:"100%",textAlign:"center"}},e.createElement(R.A,{className:`${s.bold} ${l&&s.smallFont}`,variant:"h6"},e.createElement(Pe.M,{text:Pt()(d.toLocaleUpperCase("en-US"),a)}))),t&&e.createElement(R.A,{variant:"subtitle1"},r));return o?e.createElement(H.N_,{to:o,variant:"body2"},c):c},Ht=({className:a,entity:t,relationsType:r,relationAggregation:o,entityFilterKind:s,entityLimit:d=6})=>{const l=(0,Me.S)(Rt.E);if(!r&&!o)throw new Error("The relationAggregation property must be set as an EntityRelationAggregation type.");const{componentsWithCounters:c,loading:v,error:p}=Ft(t,o??r,s,d);return v?e.createElement(ye.k,null):p?e.createElement(Re._,{error:p}):e.createElement(L.A,{container:!0,className:a},c?.map(f=>e.createElement(L.A,{item:!0,xs:6,md:6,lg:4,key:f.type??f.kind},e.createElement(Kt,{counter:f.counter,kind:f.kind,type:f.type,url:l&&`${l()}/?${f.queryParams}`}))))},Qt=(0,M.A)(a=>({card:{maxHeight:"100%"},cardContent:{display:"flex",flexDirection:"column",overflow:"hidden"},list:{[a.breakpoints.down("xs")]:{padding:"0 0 12px"}},listItemText:{[a.breakpoints.down("xs")]:{paddingRight:0,paddingLeft:0}},listItemSecondaryAction:{[a.breakpoints.down("xs")]:{width:"100%",top:"auto",right:"auto",position:"relative",transform:"unset"}},grid:{overflowY:"auto",marginTop:0}})),Xt=a=>{const{variant:t,entityFilterKind:r,hideRelationsToggle:o,entityLimit:s=6}=a,d=a.relationAggregation??a.relationsType,l=o===void 0?!1:o,c=Qt(),{entity:v}=(0,$.tN)(),p=v.kind==="User"?"aggregated":"direct",[f,g]=(0,e.useState)(d??p);return(0,e.useEffect)(()=>{d||g(p)},[g,p,d]),e.createElement(pe.n,{title:"Ownership",variant:t,className:c.card,cardClassName:c.cardContent},!l&&e.createElement(Ee.A,{dense:!0},e.createElement(ee.A,{className:c.list},e.createElement(te.A,{className:c.listItemText}),e.createElement(St.A,{className:c.listItemSecondaryAction},"Direct Relations",e.createElement(Q.Ay,{placement:"top",arrow:!0,title:`${f==="direct"?"Direct":"Aggregated"} Relations`},e.createElement(K.A,{color:"primary",checked:f!=="direct",onChange:()=>{g(f==="direct"?"aggregated":"direct")},name:"pin",inputProps:{"aria-label":"Ownership Type Switch"}})),"Aggregated Relations"))),e.createElement(Ht,{className:c.grid,entity:v,entityLimit:s,relationAggregation:f,entityFilterKind:r}))};var Ue=n(7370),jt=n(76059),Ge=n(18690),Yt=n(21613),Jt=n(79065),Zt=n(55704),qt=n(31072),De=n(82775),_t=n(64947);const ea=(0,M.A)(a=>({item:{height:48,width:"100%","&:hover":{background:a.palette.navigation.navItem?.hoverBackground||"#6f6f6f",color:a.palette.navigation.selectedColor},display:"flex",alignItems:"center",color:a.palette.navigation.color,padding:a.spacing(2.5),cursor:"pointer",position:"relative",background:"none",border:"none"},itemContainer:{width:"100%"},selected:{background:"#6f6f6f",color:a.palette.common.white},label:{margin:a.spacing(1.75),marginLeft:a.spacing(1),fontSize:a.typography.body2.fontSize,whiteSpace:"nowrap",overflow:"hidden","text-overflow":"ellipsis",lineHeight:1},subtitle:{fontSize:10,whiteSpace:"nowrap",overflow:"hidden","text-overflow":"ellipsis"},dropdownArrow:{position:"absolute",right:21},dropdown:{display:"flex",flexDirection:"column",alignItems:"end"},dropdownItem:{width:"100%",padding:"10px 0 10px 0","&:hover":{background:a.palette.navigation.navItem?.hoverBackground||"#6f6f6f",color:a.palette.navigation.selectedColor}},textContent:{color:a.palette.navigation.color,paddingLeft:a.spacing(4),paddingRight:a.spacing(1),fontSize:a.typography.body2.fontSize,whiteSpace:"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),{name:"BackstageSidebarSubmenuItem"}),ta=a=>{const{title:t,subtitle:r,to:o,icon:s,dropdownItems:d,exact:l}=a,c=ea(),{setIsHoveredOn:v}=(0,e.useContext)(qt.U1),p=()=>{v(!1)},f=(0,Ge.x$)(o??""),g=(0,Ge.zy)();let w=(0,De.z)(g,f,l);const[A,P]=(0,e.useState)(a.initialShowDropdown??!1),B=()=>{P(!A)};return d!==void 0?(d.some(b=>{const S=(0,Yt.o1)(b.to);return w=(0,De.z)(g,S,l),w}),e.createElement(y.A,{className:c.itemContainer},e.createElement(Q.Ay,{title:t,enterDelay:500,enterNextDelay:500},e.createElement(_t.A,{role:"button",onClick:B,onTouchStart:b=>b.stopPropagation(),className:me()(c.item,w?c.selected:void 0)},s&&e.createElement(s,{fontSize:"small"}),e.createElement(R.A,{variant:"subtitle1",component:"span",className:c.label},t,e.createElement("br",null),r&&e.createElement(R.A,{variant:"caption",component:"span",className:c.subtitle},r)),A?e.createElement(Zt.A,{className:c.dropdownArrow}):e.createElement(Jt.A,{className:c.dropdownArrow}))),d&&A&&e.createElement(y.A,{className:c.dropdown},d.map((b,S)=>e.createElement(Q.Ay,{key:S,title:b.title,enterDelay:500,enterNextDelay:500},e.createElement(H.N_,{to:b.to,underline:"none",className:c.dropdownItem,onClick:p,onTouchStart:U=>U.stopPropagation()},e.createElement(R.A,{component:"span",className:c.textContent},b.title))))))):e.createElement(y.A,{className:c.itemContainer},e.createElement(Q.Ay,{title:t,enterDelay:500,enterNextDelay:500},e.createElement(H.N_,{to:o,underline:"none",className:me()(c.item,w?c.selected:void 0),onClick:p,onTouchStart:b=>b.stopPropagation()},s&&e.createElement(s,{fontSize:"small"}),e.createElement(R.A,{variant:"subtitle1",component:"span",className:c.label},t,e.createElement("br",null),r&&e.createElement(R.A,{variant:"caption",component:"span",className:c.subtitle},r)))))};var aa=n(94223),na=n(20987);const oa=a=>{const{singularTitle:t,pluralTitle:r,icon:o,filter:s}=a,d=(0,oe.gf)(aa.K),l=(0,oe.gf)(C.v),c=(0,Me.S)(na.s),{value:v}=(0,ue.A)(async()=>{const p=await d.getBackstageIdentity();return(await l.getEntities({filter:[{kind:"group","relations.hasMember":p.userEntityRef,...s??{}}],fields:["metadata","kind"]})).items},[]);if(!v?.length)return null;if(v.length===1){const p=v[0];return e.createElement(Ue.uk,{text:t,to:c((0,u.sM)(p)),icon:o})}return e.createElement(Ue.uk,{icon:o,text:r},e.createElement(jt.O,{title:r},v?.map(function(f){return e.createElement(ta,{title:f.metadata.title||f.metadata.name,subtitle:f.metadata.namespace!==N.oQ?f.metadata.namespace:void 0,to:c((0,u.sM)(f)),icon:o,key:(0,u.U2)(f)})})))}},86486:(F,x,n)=>{"use strict";var N,u=n(4293),h=n(78920);N={value:!0},x.A=void 0;var $=h(n(14041)),C=u(n(74044)),y=(0,C.default)($.createElement("path",{d:"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z"}),"AccountTree");x.A=y},74011:(F,x,n)=>{"use strict";var N,u=n(4293),h=n(78920);N={value:!0},x.A=void 0;var $=h(n(14041)),C=u(n(74044)),y=(0,C.default)($.createElement("path",{d:"M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"}),"Cached");x.A=y},47966:(F,x,n)=>{"use strict";var N,u=n(4293),h=n(78920);N={value:!0},x.A=void 0;var $=h(n(14041)),C=u(n(74044)),y=(0,C.default)($.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");x.A=y},23127:(F,x,n)=>{"use strict";var N,u=n(4293),h=n(78920);N={value:!0},x.A=void 0;var $=h(n(14041)),C=u(n(74044)),y=(0,C.default)($.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}),"Language");x.A=y},50308:(F,x,n)=>{"use strict";const N=n(25192),u=h=>{if(!((Number.isInteger(h)||h===1/0)&&h>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const $=new N;let C=0;const y=()=>{C--,$.size>0&&$.dequeue()()},L=async(M,E,...i)=>{C++;const m=(async()=>M(...i))();E(m);try{await m}catch{}y()},K=(M,E,...i)=>{$.enqueue(L.bind(null,M,E,...i)),(async()=>(await Promise.resolve(),C<h&&$.size>0&&$.dequeue()()))()},R=(M,...E)=>new Promise(i=>{K(M,i,...E)});return Object.defineProperties(R,{activeCount:{get:()=>C},pendingCount:{get:()=>$.size},clearQueue:{value:()=>{$.clear()}}}),R};F.exports=u},65398:function(F){(function(x,n){F.exports=n()})(this,function(){var x=[],n=[],N={},u={},h={};function $(i){return typeof i=="string"?new RegExp("^"+i+"$","i"):i}function C(i,m){return i===m?m:i===i.toLowerCase()?m.toLowerCase():i===i.toUpperCase()?m.toUpperCase():i[0]===i[0].toUpperCase()?m.charAt(0).toUpperCase()+m.substr(1).toLowerCase():m.toLowerCase()}function y(i,m){return i.replace(/\$(\d{1,2})/g,function(e,z){return m[z]||""})}function L(i,m){return i.replace(m[0],function(e,z){var I=y(m[1],arguments);return C(e===""?i[z-1]:e,I)})}function K(i,m,e){if(!i.length||N.hasOwnProperty(i))return m;for(var z=e.length;z--;){var I=e[z];if(I[0].test(m))return L(m,I)}return m}function R(i,m,e){return function(z){var I=z.toLowerCase();return m.hasOwnProperty(I)?C(z,I):i.hasOwnProperty(I)?C(z,i[I]):K(I,z,e)}}function M(i,m,e,z){return function(I){var T=I.toLowerCase();return m.hasOwnProperty(T)?!0:i.hasOwnProperty(T)?!1:K(T,T,e)===T}}function E(i,m,e){var z=m===1?E.singular(i):E.plural(i);return(e?m+" ":"")+z}return E.plural=R(h,u,x),E.isPlural=M(h,u,x),E.singular=R(u,h,n),E.isSingular=M(u,h,n),E.addPluralRule=function(i,m){x.push([$(i),m])},E.addSingularRule=function(i,m){n.push([$(i),m])},E.addUncountableRule=function(i){if(typeof i=="string"){N[i.toLowerCase()]=!0;return}E.addPluralRule(i,"$0"),E.addSingularRule(i,"$0")},E.addIrregularRule=function(i,m){m=m.toLowerCase(),i=i.toLowerCase(),h[i]=m,u[m]=i},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"]].forEach(function(i){return E.addIrregularRule(i[0],i[1])}),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(function(i){return E.addPluralRule(i[0],i[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(i){return E.addSingularRule(i[0],i[1])}),["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","species","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[eé]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(E.addUncountableRule),E})},25192:F=>{class x{constructor(u){this.value=u,this.next=void 0}}class n{constructor(){this.clear()}enqueue(u){const h=new x(u);this._head?(this._tail.next=h,this._tail=h):(this._head=h,this._tail=h),this._size++}dequeue(){const u=this._head;if(u)return this._head=this._head.next,this._size--,u.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let u=this._head;for(;u;)yield u.value,u=u.next}}F.exports=n}}]);})();

//# sourceMappingURL=3207.9fe9c7ab.chunk.js.map