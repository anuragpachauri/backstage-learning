"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4315],{92303:(L,l,t)=>{t.d(l,{d:()=>v});var e=t(14041),s=t(16654),d=t(82326);function v(g){const{themeId:o,children:u,...m}=g;return e.createElement(d.Y,{themeId:o},e.createElement(s.Y,{...m}),u)}},68401:(L,l,t)=>{t.d(l,{t:()=>ut});var e=t(78560),s=t(77125),d=t(69076),v=t(86901),g=t(16249),o=t(72501),u=t(71677),m=t(58837),f=t(7031),a=t(44148),C=t(41260),D=t(6924),p=t(61783),n=t(14041),B=t(18453),I=t(49724),M=t(92367),Z=t(48108),J=t(47966),j=t(53318),F=t(18139),W=t(87290),G=t(30043),H=t(46123),$=t.n(H);function b({enabled:r}){const c=(0,F.gf)(G.v),[i]=(0,n.useState)(async()=>{if(!r)return[];const A="relations.ownedBy",y=(await c.getEntityFacets({facets:[A]})).facets[A].map(h=>h.value);return c.getEntitiesByRefs({entityRefs:y}).then(h=>h.items.filter(O=>O!==void 0).map(O=>O).sort((O,K)=>(O.metadata.namespace||"").localeCompare(K.metadata.namespace||"","en-US")||($()(O,"spec.profile.displayName")||O.metadata.title||O.metadata.name).localeCompare($()(K,"spec.profile.displayName")||K.metadata.title||K.metadata.name,"en-US")||O.kind.localeCompare(K.kind,"en-US"))).then(h=>h).catch(()=>[])});return(0,W.A)(async(A,S)=>{const y=await i;if(!y)return{items:[]};const h=S?.limit??20,{text:O,start:K}=T(A),z=y.filter(_=>N(O,_)),x=K+h;return{items:z.slice(0,x),...V({entities:z,limit:x,payload:{text:O,start:x}})}},[i],{loading:!0,value:{items:[]}})}function T(r){return R(r)&&r.cursor?JSON.parse(atob(r.cursor)):{text:r.text||"",start:0}}function R(r){return!!r.cursor}function V({entities:r,limit:c,payload:i}){return r.length>c?{cursor:btoa(JSON.stringify(i))}:{}}function N(r,c){const i=r.trim();return c.kind.includes(i)||c.metadata.namespace?.includes(i)||c.metadata.name.includes(i)||c.metadata.title?.includes(i)||$()(c,"spec.profile.displayName")?.includes(i)}function Y(){const r=(0,F.gf)(G.v);return(0,W.A)(async(c,i)=>{const A=c,S=c,y=i?.limit??20;if(S.cursor){const O=await r.queryEntities({cursor:S.cursor,limit:y});return{cursor:O.pageInfo.nextCursor,items:[...S.items,...O.items]}}const h=await r.queryEntities({fullTextFilter:{term:A.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:y});return{cursor:h.pageInfo.nextCursor,items:h.items}},[],{loading:!0})}var U=t(76842);function X({mode:r,initialSelectedOwnersRefs:c}){const i=r==="owners-only",A=Y(),S=b({enabled:i}),[y,h]=i?S:A;return[y,h,w({enabled:!i,initialSelectedOwnersRefs:c})]}function w({enabled:r,initialSelectedOwnersRefs:c}){const i=(0,n.useRef)({}),A=(0,F.gf)(G.v),[,S]=(0,W.A)(async()=>{(await A.getEntitiesByRefs({entityRefs:c})).items.forEach(h=>{h&&(i.current[(0,e.U2)(h)]=h)})},[]);return(0,U.u)(()=>{r&&c.length>0&&S()}),{getEntity:y=>i.current[y],setEntity:y=>{i.current[(0,e.U2)(y)]=y}}}var tt=t(46509),ot=t(96403),et=t(80084),nt=t(10265);const k=(0,m.A)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),lt=(0,f.A)(r=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(v.A),rt=n.createElement(C.A,{fontSize:"small"}),ct=n.createElement(a.A,{fontSize:"small"});function it(r){const c=k(),i=r.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:A}=(0,tt.f)(r.entity);return n.createElement(s.A,{className:c.fullWidth},n.createElement(lt,{className:c.fullWidth,control:n.createElement(d.A,{icon:rt,checkedIcon:ct,checked:r.isSelected}),onClick:S=>S.preventDefault(),label:n.createElement(u.Ay,{title:A},n.createElement(s.A,{display:"flex",alignItems:"center"},i?n.createElement(J.A,{fontSize:"small"}):n.createElement(Z.A,{fontSize:"small"}),"\xA0",n.createElement(s.A,{className:c.boxLabel},n.createElement(o.A,{noWrap:!0},A))))}))}const ut=r=>{const c=k(),{mode:i="owners-only"}=r||{},{updateFilters:A,filters:S,queryParameters:{owners:y}}=(0,B.nK)(),[h,O]=(0,n.useState)(""),{t:K}=(0,nt.i)(et.j),z=(0,n.useMemo)(()=>[y].flat().filter(Boolean),[y]),[x,_]=(0,n.useState)(z.length?z:S.owners?.values??[]),[{value:q,loading:mt},at,st]=X({mode:i,initialSelectedOwnersRefs:x});(0,M.s)(()=>at({text:h}),[h,at],250);const dt=q?.items||[];return(0,n.useEffect)(()=>{if(z.length){const E=new I.N9(z);_(E.values)}},[z]),(0,n.useEffect)(()=>{A({owners:x.length?new I.N9(x):void 0})},[x,A]),["user","group"].includes(S.kind?.value.toLocaleLowerCase("en-US")||"")?null:n.createElement(s.A,{className:c.root,pb:1,pt:1},n.createElement(o.A,{className:c.label,variant:"button",component:"label"},K("entityOwnerPicker.title"),n.createElement(p.Ay,{PopperComponent:E=>n.createElement("div",{...E},E.children),multiple:!0,disableCloseOnSelect:!0,loading:mt,options:dt,value:x,getOptionSelected:(E,P)=>typeof P=="string"?(0,e.U2)(E)===P:E===P,getOptionLabel:E=>{const P=typeof E=="string"?st.getEntity(E)||(0,e.KU)(E,{defaultKind:"group",defaultNamespace:"default"}):E;return(0,j.Z)(P,(0,j.S)(P))},onChange:(E,P)=>{O(""),_(P.map(Q=>{const Et=typeof Q=="string"?Q:(0,e.U2)(Q);return typeof Q!="string"&&st.setEntity(Q),Et}))},filterOptions:E=>E,renderOption:(E,{selected:P})=>n.createElement(it,{entity:E,isSelected:P}),size:"small",popupIcon:n.createElement(D.A,{"data-testid":"owner-picker-expand"}),renderInput:E=>n.createElement(g.A,{...E,className:c.input,onChange:P=>{O(P.currentTarget.value)},variant:"outlined"}),ListboxProps:{onScroll:E=>{const P=E.currentTarget;Math.abs(P.scrollHeight-P.clientHeight-P.scrollTop)<1&&q?.cursor&&at({items:q.items,cursor:q.cursor})},"data-testid":"owner-picker-listbox"}})))}},19108:(L,l,t)=>{t.d(l,{A:()=>e,G:()=>s});const e="backstage.io/techdocs-ref",s="backstage.io/techdocs-entity"},4348:(L,l,t)=>{t.d(l,{V:()=>e});function e(s,d){return d.getOptionalBoolean("techdocs.legacyUseCaseSensitiveTripletPaths")?s:s.toLocaleLowerCase("en-US")}},67633:(L,l,t)=>{t.d(l,{o:()=>M});var e=t(14041),s=t(36338),d=t(72814),v=t(18139),g=t(54195),o=t(97214),u=t(699),m=t(53318),f=t(17749),a=t(29021),C=t(65995),D=t(87318),p=t(143),n=t(48751),B=t(4348);const I=[n.B.createTitleColumn({hidden:!0}),n.B.createNameColumn(),n.B.createOwnerColumn(),n.B.createKindColumn(),n.B.createTypeColumn()],M=Z=>{const{entities:J,title:j,loading:F,columns:W,actions:G,options:H}=Z,[,$]=(0,s.A)(),b=(0,d.S)(f.Oc),T=(0,v.gf)(g.U);if(!J)return null;const R=J.map(U=>{const X=(0,u.t)(U,o.vv);return{entity:U,resolved:{docsUrl:b({namespace:(0,B.V)(U.metadata.namespace??"default",T),kind:(0,B.V)(U.kind,T),name:(0,B.V)(U.metadata.name,T)}),ownedByRelations:X,ownedByRelationsTitle:X.map(w=>(0,m.S)(w,{defaultKind:"group"})).join(", ")}}}),V=[p.f.createCopyDocsUrlAction($)],N=20,Y=R&&R.length>N;return e.createElement(e.Fragment,null,F||R&&R.length>0?e.createElement(a.X,{isLoading:F,options:{paging:Y,pageSize:N,search:!0,actionsColumnIndex:-1,...H},data:R,columns:W||I,actions:G||V,title:j?`${j} (${R.length})`:`All (${R.length})`}):e.createElement(C.p,{missing:"data",title:"No documents to show",description:"Create your own document. Check out our Getting Started Information",action:e.createElement(D.z,{color:"primary",to:"https://backstage.io/docs/features/techdocs/getting-started",variant:"contained"},"DOCS")}))};M.columns=n.B,M.actions=p.f},143:(L,l,t)=>{t.d(l,{f:()=>u});var e=t(14041),s=t(55290),d=t(7031),v=t(80109),g=t(15303);const o=(0,d.A)({root:{color:"#f3ba37"}})(v.A),u={createCopyDocsUrlAction(m){return f=>({icon:()=>e.createElement(s.A,{fontSize:"small"}),tooltip:"Click to copy documentation link to clipboard",onClick:()=>m(`${window.location.origin}${f.resolved.docsUrl}`)})},createStarEntityAction(m,f){return a=>{const C=a.entity,D=m(C);return{cellStyle:{paddingLeft:"1em"},icon:()=>D?e.createElement(o,null):e.createElement(g.A,null),tooltip:D?"Remove from favorites":"Add to favorites",onClick:()=>f(C)}}}}},48751:(L,l,t)=>{t.d(l,{B:()=>f});var e=t(14041),s=t(77125),d=t(58837);const v=(0,d.A)(a=>({value:{marginBottom:a.spacing(.75)},subvalue:{color:a.palette.textSubtle,fontWeight:"normal"}}),{name:"BackstageSubvalueCell"});function g(a){const{value:C,subvalue:D}=a,p=v();return e.createElement(e.Fragment,null,e.createElement(s.A,{className:p.value},C),e.createElement(s.A,{className:p.subvalue},D))}var o=t(75202),u=t(14158);function m(a){return a.metadata.title||a.metadata.name}const f={createTitleColumn(a){return{...f.createNameColumn(),field:"entity.metadata.title",hidden:a?.hidden}},createNameColumn(){return{title:"Document",field:"entity.metadata.name",highlight:!0,searchable:!0,defaultSort:"asc",customSort:(a,C)=>{const D=m(a.entity).toLocaleLowerCase(),p=m(C.entity).toLocaleLowerCase();return D.localeCompare(p)},render:a=>e.createElement(g,{value:e.createElement(o.N_,{to:a.resolved.docsUrl},m(a.entity)),subvalue:a.entity.metadata.description})}},createOwnerColumn(){return{title:"Owner",field:"resolved.ownedByRelationsTitle",render:({resolved:a})=>e.createElement(u.i,{entityRefs:a.ownedByRelations,defaultKind:"group"})}},createKindColumn(){return{title:"Kind",field:"entity.kind"}},createTypeColumn(){return{title:"Type",field:"entity.spec.type"}}}},4315:(L,l,t)=>{t.r(l),t.d(l,{TechDocsIndexPage:()=>b});var e=t(14041),s=t(18690),d=t(16454),v=t(17138),g=t(56420),o=t(18453),u=t(77509),m=t(30117),f=t(68401),a=t(56829),C=t(88461),D=t(24259),p=t(19108);class n{getCatalogFilters(){return{[`metadata.annotations.${p.A}`]:D.c}}}const B=()=>{const{updateFilters:T}=(0,o.nK)();return(0,e.useEffect)(()=>{T({techdocs:new n})},[T]),null};var I=t(36338),M=t(45250),Z=t(99338),J=t(62112),j=t(44861),F=t(67633),W=t(143),G=t(48751);const H=T=>{const{columns:R,actions:V,options:N}=T,{loading:Y,error:U,entities:X,filters:w}=(0,o.nK)(),{isStarredEntity:tt,toggleStarredEntity:ot}=(0,j.I)(),[,et]=(0,I.A)(),nt=(0,M.capitalize)(w.user?.value??"all"),k=[W.f.createCopyDocsUrlAction(et),W.f.createStarEntityAction(tt,ot)];return U?e.createElement(Z.B,{severity:"error",title:"Could not load available documentation."},e.createElement(J.z,{language:"text",text:U.toString()})):e.createElement(F.o,{title:nt,entities:X,loading:Y,actions:V||k,columns:R,options:N})};H.columns=G.B,H.actions=W.f;const $=T=>{const{initialFilter:R="owned",columns:V,actions:N,ownerPickerMode:Y}=T;return e.createElement(C.S,null,e.createElement(d.U,null,e.createElement(v.d,{title:""},e.createElement(g.Y,null,"Discover documentation in your ecosystem.")),e.createElement(o.B9,null,e.createElement(u.GI,null,e.createElement(u.GI.Filters,null,e.createElement(B,null),e.createElement(m.y,{initialFilter:R}),e.createElement(f.t,{mode:Y}),e.createElement(a.m,null)),e.createElement(u.GI.Content,null,e.createElement(H,{actions:N,columns:V}))))))},b=T=>(0,s.P1)()||e.createElement($,{...T})},88461:(L,l,t)=>{t.d(l,{S:()=>g});var e=t(14041),s=t(92303),d=t(18139),v=t(54195);const g=o=>{const{children:u}=o,f=`Documentation available in ${(0,d.gf)(v.U).getOptionalString("organization.name")??"Backstage"}`;return e.createElement(s.d,{title:"Documentation",subtitle:f,themeId:"documentation"},u)}},47966:(L,l,t)=>{var e,s=t(4293),d=t(78920);e={value:!0},l.A=void 0;var v=d(t(14041)),g=s(t(74044)),o=(0,g.default)(v.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");l.A=o},55290:(L,l,t)=>{var e,s=t(4293),d=t(78920);e={value:!0},l.A=void 0;var v=d(t(14041)),g=s(t(74044)),o=(0,g.default)(v.createElement("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"}),"Share");l.A=o},92367:(L,l,t)=>{t.d(l,{s:()=>g});var e=t(14041),s=t(16261);function d(o){const u=(0,s.J)(o);(0,e.useEffect)(()=>()=>{u.current()},[])}function v(o,u,m,f=0){const a=(0,e.useRef)(),C=(0,e.useRef)(),D=(0,e.useRef)(o),p=(0,e.useRef)(),n=()=>{a.current&&(clearTimeout(a.current),a.current=void 0),C.current&&(clearTimeout(C.current),C.current=void 0)};return d(n),(0,e.useEffect)(()=>{D.current=o},u),(0,e.useMemo)(()=>{const B=()=>{if(n(),!p.current)return;const M=p.current;p.current=void 0,D.current.apply(M.this,M.args)},I=function(...M){a.current&&clearTimeout(a.current),p.current={args:M,this:this},a.current=setTimeout(B,m),f>0&&!C.current&&(C.current=setTimeout(B,f))};return Object.defineProperties(I,{length:{value:o.length},name:{value:`${o.name||"anonymous"}__debounced__${m}`}}),I},[m,f,...u])}function g(o,u,m,f=0){(0,e.useEffect)(v(o,u,m,f),u)}}}]);})();

//# sourceMappingURL=4315.24e8c3ae.chunk.js.map